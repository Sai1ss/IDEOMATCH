{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
  <!-- Swiper CSS -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"
  >
  <!-- CSS -->
  <link href="{% static 'css/home.css' %}" rel="stylesheet">
{% endblock %}



{% block content %}
<!-- Sección autenticaciion -->
  {% if user.is_authenticated and nombre_usuario %}
    <div class="welcome-banner text-center" id="welcome-banner">
      <div class="container">
        <h2 class="welcome-message">¡Bienvenido, {{ nombre_usuario }}!</h2>
      </div>
    </div>
  {% endif %}

<!-- Mensajes tipo toast -->
  {% if messages %}
  <div aria-live="polite" aria-atomic="true" class="position-fixed top-0 end-0 p-3" style="z-index: 1100;">
    {% for message in messages %}
    <div class="toast align-items-center text-bg-{{ message.tags }} border-0 show mb-2" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000">
      <div class="d-flex">
        <div class="toast-body">
          {% if message.tags == "success" %}✅{% elif message.tags == "error" %}❌{% elif message.tags == "warning" %}⚠️{% endif %}
          {{ message }}
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
    </div>
    {% endfor %}
  </div>
  {% endif %}




<!-- Hero Parallax -->



  <section class="hero-section">
    <div class="overlay">
      <div class="container text-center hero-content">
        <img src="{% static 'images/LOGO IDEOMATCH.png' %}" alt="IdeoMatch Logo" class="hero-logo animated-on-scroll">
        <p class="lead animated-on-scroll delay-1">Descubre tu compatibilidad con los candidatos presidenciales 2025.</p>
        <a href="#acciones" class="btn-ideomatch-primary animated-on-scroll delay-2">Comenzar</a>
        <br>
        <br><br>
        <br><br>
        <br>

        <!-- NUEVA SECCIÓN ¿Sabías que…? -->
        <section class="facts-home py-5">
          <div class="container">
            <h3 class="sabias-title text-center mb-4 fw-semibold animated-on-scroll">
              ¿Sabías que…?
            </h3>

            <!-- El JS insertará aquí la frase que rota cada 5 s -->
            <div id="factHomeBox" class="fact-home-box mx-auto animated-on-scroll delay-1"></div>
          </div>
        </section>
      </div>
    </div>

  </section>







  <!-- Sección de Acciones / Cards -->
  <section id="acciones" class="py-5 section-gray">
    <div class="container">
      <h2 class="section-title animated-on-scroll">Nuestros Servicios</h2>
      <div class="row g-4 justify-content-center">

        <!-- Métricas -->
        <div class="col-md-6 col-lg-3">
          <div class="card card-metricas animated-on-scroll delay-1">
            <div class="card-body d-flex flex-column">
              <div class="metric-icon mb-3"><i class="bi bi-graph-up-arrow"></i></div>
              <h5 class="card-title text-center">Estadísticas</h5>
              <p class="card-text text-center flex-grow-1">Seguimiento de tendencias y comportamiento electoral</p>
              <a href="{% url 'dashboard' %}" class="btn-custom-secondary mt-auto">
                Ver Estadísticas <i class="bi bi-chevron-right"></i>
              </a>
            </div>
          </div>
        </div>

        <!-- Cuestionario -->
        <div class="col-md-8 col-lg-5">
          <div class="card card-cuestionario highlighted animated-on-scroll delay-2">
            <div class="card-body d-flex flex-column">
              <div class="module-badge">¡Hazlo ya!</div>
              <h3 class="card-title text-center mb-3">Test de Compatibilidad política</h3>
              <p class="card-text text-center flex-grow-1">¡Votar informado nunca fue tan fácil!</p>
              <div class="feature-list mb-4">
                <div class="feature-item">
                  <i class="bi bi-check2-circle"></i>
                  <span>Selección de preguntas clave</span>
                </div>
                <div class="feature-item">
                  <i class="bi bi-bar-chart"></i>
                  <span>Resultados detallados</span>
                </div>
              </div>
              <a href="{% url 'cuestionario' %}" class="btn-ideomatch-primary mt-auto">
                Comenzar Test <i class="bi bi-chevron-right"></i>
              </a>
            </div>
          </div>
        </div>

        <!-- Datos Electorales -->
        <div class="col-md-6 col-lg-3">
          <div class="card card-servel animated-on-scroll delay-3">
            <div class="card-body d-flex flex-column">
              <div class="metric-icon mb-3"><i class="bi bi-search"></i></div>
              <h5 class="card-title text-center">Consulta Electoral</h5>
              <p class="card-text text-center flex-grow-1">Acceso directo a datos oficiales del SERVEL y consultas electorales</p>
              <a href="https://consulta.servel.cl/" target="_blank" class="btn-custom-secondary mt-3">
                Ver datos electorales <i class="bi bi-box-arrow-up-right"></i>
              </a>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>




  <!-- Parallax Intermedio -->
  <section class="secondary-parallax">
    <div class="overlay"></div>
    <div class="parallax-content text-center animated-on-scroll delay-1">
      <h2>Potencia tu voz en la elección 2025</h2>
      <p>Accede a estadísticas y tendencias para tomar la mejor decisión.</p>
    </div>
  </section>

<!-- Sección Candidatos Presidenciales -->
<!-- ════════════ CANDIDATOS PRESIDENCIALES ════════════ -->
  <section id="candidatos" class="py-5">
    <div class="container">
      <h2 class="section-title animated-on-scroll">
        Candidatos Presidenciales
      </h2>

      <!-- ─── Slider Swiper ─── -->
      <div class="swiper candidatos-swiper">
        <div class="swiper-wrapper">

          <!-- 1 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/carolina_toha.jpg' %}" alt="Carolina Tohá">
              <h5>Carolina Tohá</h5>
              <p class="party">Partido Socialista</p>
            </div>
          </div>

          <!-- 2 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/evelyn_matthei.jpeg' %}" alt="Evelyn Matthei">
              <h5>Evelyn Matthei</h5>
              <p class="party">UDI</p>
            </div>
          </div>

          <!-- 3 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/franco_parisi.jpeg' %}" alt="Franco Parisi">
              <h5>Franco Parisi</h5>
              <p class="party">Partido de la Gente</p>
            </div>
          </div>

          <!-- 4 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/johannes_kaiser.jpg' %}" alt="Johannes Kaiser">
              <h5>Johannes Kaiser</h5>
              <p class="party">RN</p>
            </div>
          </div>

          <!-- 5 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/jose_antonio_kast.jpg' %}" alt="José Antonio Kast">
              <h5>José Antonio Kast</h5>
              <p class="party">Partido Republicano</p>
            </div>
          </div>

          <!-- 6 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/gonzalo_winter.png' %}" alt="Gonzalo Winter">
              <h5>Gonzalo Winter</h5>
              <p class="party">Revolución Democrática</p>
            </div>
          </div>

          <!-- 7 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/jaime_mulet.webp' %}" alt="Jaime Mulet">
              <h5>Jaime Mulet</h5>
              <p class="party">PRSD</p>
            </div>
          </div>

          <!-- 8 -->
          <div class="swiper-slide">
            <div class="candidate-card">
              <img src="{% static 'images/jeannette_jar.jpg' %}" alt="Jeannette Jara">
              <h5>Jeannette Jara</h5>
              <p class="party">Partido Socialista</p>
            </div>
          </div>

        </div>
        <!-- Bullets de paginación -->
        <div class="swiper-pagination"></div>
      </div>

      <div class="text-center mt-4 animated-on-scroll">
        <a href="{% url 'candidatos' %}" class="btn-ideomatch-primary">
          Ver Todos los Candidatos
          <i class="bi bi-person-lines-fill ms-2"></i>
        </a>
      </div>
    </div>
  </section>
{% endblock %}




{% block extra_js %}
  <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <!--home.js -->
    <script src="{% static 'js/home.js' %}"></script>


    <!-- script de frases -->
  <script>
    document.querySelectorAll('.scroll-btn').forEach(button => {
      button.addEventListener('click', () => {
        const scrollContainer = document.querySelector('.candidates-scroll');
        const scrollAmount = button.classList.contains('left') ? -300 : 300;
        scrollContainer.scrollBy({ left: scrollAmount, behavior: 'smooth' });
      });
    });

    const animatedElements = document.querySelectorAll('.animated-on-scroll');
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
        }
      });
    }, { threshold: 0.1 });

    animatedElements.forEach(element => {
      observer.observe(element);
    });


    // Desaparece la franja de bienvenida después de 6 segundos
    setTimeout(() => {
      const banner = document.getElementById('welcome-banner');
      if (banner) {
        banner.style.transition = 'opacity 1s ease-out';
        banner.style.opacity = '0';
        setTimeout(() => {
          banner.style.display = 'none';
        }, 1000); // desvanecimiento
      }
    }, 6000); // 6 segundos
    
  </script>
{% endblock %}
